import{r as x,j as e}from"./index-B_gVeGiv.js";import"./katex-p018AHG0.js";import{D as ft}from"./StepByStep-BYyVPvbC.js";import{c as M}from"./formatting-BPjMr18d.js";import{a as yt,e as K,m as ht,b as gt,n as mt,d as W,f as E,v as jt,g as Z}from"./physics-DhkSNVl6.js";const k=900,D=560,i={xmin:-10,xmax:10,ymin:-7,ymax:7},P=5;function tt({x:d,y:j,vx:c,vy:l,toX:v,toY:b,color:w,lenWorld:I=.5}){const s=jt({x:c,y:l}),C={x:d+s.x*I,y:j+s.y*I},S=v(d),B=b(j),p=v(C.x),a=b(C.y),f=6,y=Math.atan2(a-B,p-S),N=p-f*Math.cos(y),R=a-f*Math.sin(y),h={x:N+f*.6*Math.cos(y+Math.PI/2),y:R+f*.6*Math.sin(y+Math.PI/2)},X={x:N+f*.6*Math.cos(y-Math.PI/2),y:R+f*.6*Math.sin(y-Math.PI/2)};return e.jsxs("g",{children:[e.jsx("line",{x1:S,y1:B,x2:p,y2:a,stroke:w,strokeWidth:2}),e.jsx("polygon",{points:`${p},${a} ${h.x},${h.y} ${X.x},${X.y}`,fill:w})]})}function Wt(){const d=x.useRef(null),j=x.useMemo(()=>yt(k,D,i),[]),{toX:c,toY:l,fromX:v,fromY:b,offsetX:w,offsetY:I}=j,[s,C]=x.useState({x:-1.5,y:0}),[S,B]=x.useState(500),p=ht(S),[a,f]=x.useState({x:2,y:1}),[y,N]=x.useState(1),R=mt(y),[h,X]=x.useState(!1),[_,et]=x.useState(!0),[z,nt]=x.useState(28),[G,ot]=x.useState(.8),[A,g]=x.useState(null),[it,rt]=x.useState(null),T=x.useMemo(()=>K(a,s,p),[a,s,p]),$=x.useMemo(()=>gt(T,R),[T,R]),st=x.useMemo(()=>{const t=[],n=z,o=Math.round(z*((i.ymax-i.ymin)/(i.xmax-i.xmin)));for(let r=0;r<n;r++){const u=i.xmin+(r+.5)*(i.xmax-i.xmin)/n;for(let q=0;q<o;q++){const H=i.ymin+(q+.5)*(i.ymax-i.ymin)/o;(u-s.x)**2+(H-s.y)**2<.06*.06||t.push({x:u,y:H})}}return t},[z,s]);function Q(t){return G*(1-Math.exp(-t/2e5))}const m=x.useRef(null);function at(t,n){const o=d.current;if(!o)return{x:0,y:0};const r=o.getBoundingClientRect(),u=Z(t,n,r,k,D);return{x:v(u.x),y:b(u.y)}}function V(t,n){const o=d.current;if(!o)return{x:0,y:0};const r=o.getBoundingClientRect();return Z(t,n,r,k,D)}function Y(t,n,o=22){const r=c(n.x),u=l(n.y),q=r-t.x,H=u-t.y;return Math.hypot(q,H)<=o}function O(t,n,o){let r=at(t,n);r.x=M(r.x,i.xmin,i.xmax),r.y=M(r.y,i.ymin,i.ymax),o==="source"?(r=W(r,a,P),C(r)):(r=W(r,s,P),f(r))}function U(t){return n=>{n.preventDefault(),n.stopPropagation();const o=n.touches[0];m.current={id:o.identifier,target:t},g(t)}}function ct(t){if(!m.current)return;t.preventDefault();const n=Array.from(t.touches).find(o=>o.identifier===m.current.id);n&&O(n.clientX,n.clientY,m.current.target)}function J(t){if(!m.current)return;Array.from(t.touches).some(o=>o.identifier===m.current.id)||(m.current=null,g(null))}function lt(t){var r,u;if(t.pointerType==="touch")return;t.preventDefault();const n=V(t.clientX,t.clientY);let o=null;Y(n,s,22)?o="source":h&&Y(n,a,22)&&(o="test"),o&&(g(o),(u=(r=d.current)==null?void 0:r.setPointerCapture)==null||u.call(r,t.pointerId))}function xt(t){if(t.pointerType==="touch")return;const n=V(t.clientX,t.clientY);if(!A){const o=Y(n,s,14)?"source":h&&Y(n,a,14)?"test":null;rt(o);return}t.preventDefault(),O(t.clientX,t.clientY,A)}function dt(t){var n,o;if(t.pointerType!=="touch"){try{(o=(n=d.current)==null?void 0:n.releasePointerCapture)==null||o.call(n,t.pointerId)}catch{}g(null)}}function ut(t){t.pointerType!=="touch"&&g(null)}const L={background:"#fff",borderRadius:16,padding:12,boxShadow:"0 1px 4px rgba(0,0,0,0.1)"},pt=A?"grabbing":it?"grab":"crosshair";return e.jsxs(ft,{title:"Campo elettrico (carica puntiforme)",description:"Trascina la carica sorgente e la carica di prova. Distanza bloccata a â‰¤ 5 m.",children:[e.jsxs("div",{style:L,children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12,flexWrap:"wrap",gap:8},children:[e.jsx("div",{style:{fontWeight:600,fontSize:16},children:"Piano (x,y) in metri"}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsxs("button",{onClick:()=>et(t=>!t),style:{padding:"8px 16px",borderRadius:8,border:"1px solid #d1d5db",background:_?"#dbeafe":"#fff",cursor:"pointer",fontWeight:500},children:[_?"Nascondi":"Mostra"," vettori"]}),e.jsxs("button",{onClick:()=>X(t=>!t),style:{padding:"8px 16px",borderRadius:8,border:"1px solid #d1d5db",background:h?"#fef3c7":"#fff",cursor:"pointer",fontWeight:500},children:[h?"Nascondi":"Mostra"," carica prova"]})]})]}),e.jsxs("svg",{ref:d,viewBox:`0 0 ${k} ${D}`,preserveAspectRatio:"xMidYMid meet",style:{width:"100%",height:"auto",maxHeight:"70vh",cursor:pt,touchAction:"none",display:"block",margin:"0 auto"},onPointerDown:lt,onPointerMove:xt,onPointerUp:dt,onPointerLeave:ut,onTouchMove:ct,onTouchEnd:J,onTouchCancel:J,children:[e.jsx("rect",{x:0,y:0,width:k,height:D,fill:"#fff",rx:16}),Array.from({length:11},(t,n)=>i.xmin+n*(i.xmax-i.xmin)/10).map(t=>e.jsx("line",{x1:c(t),y1:I,x2:c(t),y2:D-I,stroke:"#eef2f7"},`vx-${t}`)),Array.from({length:8},(t,n)=>i.ymin+n*(i.ymax-i.ymin)/7).map(t=>e.jsx("line",{x1:w,y1:l(t),x2:k-w,y2:l(t),stroke:"#eef2f7"},`vy-${t}`)),e.jsx("line",{x1:c(i.xmin),y1:l(0),x2:c(i.xmax),y2:l(0),stroke:"#0f172a",strokeWidth:1.5}),e.jsx("line",{x1:c(0),y1:l(i.ymin),x2:c(0),y2:l(i.ymax),stroke:"#0f172a",strokeWidth:1.5}),_&&st.map((t,n)=>{const o=K(t,s,p),r=Q(o.Emag),u=p>=0?"#2563eb":"#1d4ed8";return e.jsx(tt,{x:t.x,y:t.y,vx:o.Ex,vy:o.Ey,lenWorld:r,toX:c,toY:l,color:u},n)}),e.jsxs("g",{style:{cursor:A==="source"?"grabbing":"grab"},children:[e.jsx("circle",{cx:c(s.x),cy:l(s.y),r:40,fill:"transparent",style:{touchAction:"none"},onTouchStart:U("source"),onPointerDown:t=>{var n,o;t.pointerType!=="touch"&&(t.preventDefault(),t.stopPropagation(),g("source"),(o=(n=d.current)==null?void 0:n.setPointerCapture)==null||o.call(n,t.pointerId))}}),e.jsx("circle",{cx:c(s.x),cy:l(s.y),r:18,fill:p>=0?"#ef4444":"#3b82f6",stroke:"#0f172a",strokeWidth:2,pointerEvents:"none"}),e.jsx("text",{x:c(s.x),y:l(s.y)+6,fontSize:22,textAnchor:"middle",fill:"#fff",fontWeight:700,pointerEvents:"none",children:p>=0?"+":"âˆ’"}),e.jsxs("text",{x:c(s.x)+24,y:l(s.y)-22,fontSize:14,fill:"#0f172a",fontWeight:500,pointerEvents:"none",children:["q = ",S.toFixed(1)," Î¼C"]})]}),h&&e.jsxs("g",{style:{cursor:A==="test"?"grabbing":"grab"},children:[e.jsx(tt,{x:a.x,y:a.y,vx:$.Fx,vy:$.Fy,lenWorld:Q(T.Emag)*.9,toX:c,toY:l,color:"#10b981"}),e.jsx("circle",{cx:c(a.x),cy:l(a.y),r:35,fill:"transparent",style:{touchAction:"none"},onTouchStart:U("test"),onPointerDown:t=>{var n,o;t.pointerType!=="touch"&&(t.preventDefault(),t.stopPropagation(),g("test"),(o=(n=d.current)==null?void 0:n.setPointerCapture)==null||o.call(n,t.pointerId))}}),e.jsx("circle",{cx:c(a.x),cy:l(a.y),r:14,fill:"#f59e0b",stroke:"#0f172a",strokeWidth:2,pointerEvents:"none"}),e.jsxs("text",{x:c(a.x)+18,y:l(a.y)-16,fontSize:14,fill:"#0f172a",fontWeight:500,pointerEvents:"none",children:["q_t = ",y.toFixed(1)," nC"]})]})]}),e.jsxs("div",{style:{display:"flex",gap:24,alignItems:"center",marginTop:16,flexWrap:"wrap",justifyContent:"center"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{style:{fontWeight:500},children:"DensitÃ  griglia"}),e.jsx("input",{type:"range",min:8,max:28,step:1,value:z,onChange:t=>nt(parseInt(t.target.value))}),e.jsx("span",{style:{background:"#e2e8f0",borderRadius:999,fontSize:12,padding:"2px 10px",minWidth:30,textAlign:"center"},children:z})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{style:{fontWeight:500},children:"Scala vettori"}),e.jsx("input",{type:"range",min:.2,max:1.2,step:.05,value:G,onChange:t=>ot(parseFloat(t.target.value))}),e.jsxs("span",{style:{background:"#e2e8f0",borderRadius:999,fontSize:12,padding:"2px 10px",minWidth:50,textAlign:"center"},children:[G.toFixed(2)," m"]})]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"auto auto 1fr",gap:16,marginTop:16},children:[e.jsxs("div",{style:{...L,padding:"12px 16px"},children:[e.jsx("div",{style:{fontWeight:600,marginBottom:8,color:"#ef4444",fontSize:14},children:"âŠ• Carica sorgente"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[e.jsx(F,{label:"x",unit:"m",value:s.x,step:.1,onChange:t=>{const n=M(t,i.xmin,i.xmax);let o={...s,x:n};o=W(o,a,P),C(o)}}),e.jsx(F,{label:"y",unit:"m",value:s.y,step:.1,onChange:t=>{const n=M(t,i.ymin,i.ymax);let o={...s,y:n};o=W(o,a,P),C(o)}}),e.jsx(F,{label:"q",unit:"Î¼C",value:S,step:10,onChange:B})]})]}),e.jsxs("div",{style:{...L,padding:"12px 16px"},children:[e.jsx("div",{style:{fontWeight:600,marginBottom:8,color:"#f59e0b",fontSize:14},children:"â—‰ Carica di prova"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[e.jsx(F,{label:"x",unit:"m",value:a.x,step:.1,onChange:t=>{const n=M(t,i.xmin,i.xmax);let o={...a,x:n};o=W(o,s,P),f(o)}}),e.jsx(F,{label:"y",unit:"m",value:a.y,step:.1,onChange:t=>{const n=M(t,i.ymin,i.ymax);let o={...a,y:n};o=W(o,s,P),f(o)}}),e.jsx(F,{label:"q_t",unit:"nC",value:y,step:.1,onChange:N})]})]}),e.jsxs("div",{style:{...L,background:"#f0fdf4"},children:[e.jsx("div",{style:{fontWeight:600,marginBottom:8,color:"#10b981"},children:"ðŸ“Š Misure al punto di prova"}),e.jsxs("div",{style:{fontSize:13,display:"grid",gap:4},children:[e.jsxs("div",{children:[e.jsx("b",{children:"E"})," = (",E(T.Ex),", ",E(T.Ey),") N/C"]}),e.jsxs("div",{children:["|",e.jsx("b",{children:"E"}),"| = ",e.jsx("span",{style:{color:"#2563eb",fontWeight:600},children:E(T.Emag)})," N/C"]}),e.jsxs("div",{children:[e.jsx("b",{children:"F"})," = qÂ·E = (",E($.Fx),", ",E($.Fy),") N"]}),e.jsxs("div",{children:["|",e.jsx("b",{children:"F"}),"| = ",e.jsx("span",{style:{color:"#10b981",fontWeight:600},children:E($.Fmag)})," N"]})]})]})]})]})}function F({label:d,unit:j,value:c,step:l,onChange:v}){return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{style:{color:"#64748b",fontSize:13,minWidth:24},children:d}),e.jsx("input",{type:"number",value:c,step:l,onChange:b=>v(parseFloat(b.target.value)||0),style:{padding:"4px 8px",borderRadius:4,border:"1px solid #d1d5db",fontSize:13,width:70,textAlign:"right"}}),e.jsx("span",{style:{color:"#94a3b8",fontSize:12},children:j})]})}export{Wt as default};
